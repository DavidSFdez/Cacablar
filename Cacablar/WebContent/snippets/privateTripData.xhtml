<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<h3>#Pasajeros</h3>
	<p:dataTable id="asientos" var="var" value="#{trip.getSeats()}"
		border="1">
		<p:column>
			<f:facet name="header">#IDUser</f:facet>#{var.userId}</p:column>
		<p:column>
			<f:facet name="header">#Comment</f:facet>#{var.comment}</p:column>
		<p:column>
			<f:facet name="header">#Status</f:facet>#{var.status}</p:column>
		<p:column>
			<f:facet name="header">#Action</f:facet>
			<p:commandButton value="#Cancelar plaza"
				action="#{seat.cancelSeat(var)}"
				rendered="#{( trip.isSitting(user.user.id) and var.userId == user.user.id ) || (trip.isPromoter(user.user.id) and var.status.accepted)}" />
		</p:column>
	</p:dataTable>

	<h:form rendered="#{trip.isUserInApplications(user.user.id)}">
		<h:outputText value="#Su petición todavía se encuentra pendiente: " />
		<p:commandButton value="#Cancelar solicitud" action="#{trip.cancelApplication(user.user.id,trip.trip.id)}" />
	</h:form>
	
	<!--  Peta pero funciona (wtf) (He puesto el == false en vez de ! para que eclipse no llore -->
	<h:form rendered="#{trip.isUserRelated(user.user.id) == false}">
		<p:commandButton value="#Solicitar Plaza"
			action="#{seat.request(user.user.id,trip.trip.id)}" />
	</h:form>

	<h:panelGroup rendered="#{trip.isPromoter(user.user.id)}">
		<h3>#Peticiones</h3>
		<p:dataTable id="peticiones" var="var"
			value="#{trip.getApplications()}" border="1">
			<p:column>
				<f:facet name="header">#IDUser</f:facet>#{var.userId}</p:column>
			<p:column>
				<f:facet name="header">#Actions</f:facet>
				<p:commandButton value="#Aceptar" action="#{seat.acceptRequest(var)}" ajax="false" />
				<p:commandButton value="#Rechazar"
					action="#{seat.refuseRequest(var)}" />
			</p:column>
		</p:dataTable>
	</h:panelGroup>
</ui:composition>