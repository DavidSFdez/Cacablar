<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/template-general.xhtml">

	<ui:define name="title">
   Viajes Promocionados
  </ui:define>

	<ui:define name="content">
		<p:dataTable id="tablalistado" var="var"
			value="#{trips.listRelated(user.user.id)}" border="1">

			<ui:include src="/snippets/TripTableBody.xhtml" />

			<p:column>
				<f:facet name="header">#Estado</f:facet>
			PROMOTOR, PENDIENTE, ADMITIDO, SIN_PLAZA o EXCLUIDO
			</p:column>

			<p:column>
				<f:facet name="header">#Controles</f:facet>
				<!-- Aquí iría una llamada al método value pero no funciona así que tendremos que buscar una forma equivalente -->
				<p:selectBooleanCheckbox value="#{trips.aux}"
					rendered="#{trip.isPromoter(var.id,user.user.id)}">
					<p:ajax listener="#{trips.cancel(var)}" />
				</p:selectBooleanCheckbox>


			</p:column>
		</p:dataTable>
		<!-- Botón para cancelar el viaje -->
		<p:commandButton value="Cancelar Viaje(s)"
			action="#{trips.cancelTrips(user.user.id)}">
			<p:ajax listener="#{trips.trips}" update="tablalistado"></p:ajax>
			<p:confirm header="Confirmation"
				message="Borrar viajes seleccionados ¿Estás seguro?"
				icon="ui-icon-alert"></p:confirm>
		</p:commandButton>
		<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
			<p:commandButton value="Si" type="button"
				styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
			<p:commandButton value="No" type="button"
				styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
		</p:confirmDialog>
	</ui:define>
</ui:composition>
